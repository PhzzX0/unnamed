<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoyaleHub Esports</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
    <link rel="stylesheet" href="static/style.css">
    <script src="{{ url_for('static', filename='tailwind-config.js') }}"></script>
</head>

<div x-data="cartOffCanvas" @keydown.escape="isOpen = false" class="fixed z-[60]">
    
    <!-- 1. Bot√£o Flutuante (FAB) -->
    <button @click="toggleCart(); $nextTick(() => { if(isOpen) fetchCartData() })"
        class="fixed bottom-6 right-6 lg:bottom-10 lg:right-10 
            p-4 rounded-full shadow-2xl transition duration-300 
            bg-primary hover:bg-primary/90 text-dark 
            transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-primary/50"
            aria-label="Abrir Carrinho">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
        <!-- Contador de itens no badge -->
        <span x-show="itemCount > 0" x-cloak x-text="itemCount" 
            class="absolute -top-1 -right-1 flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-red-600 border-2 border-dark rounded-full"></span>
    </button>

    <!-- 2. Overlay de Fundo (Para fechar ao clicar fora) -->
    <div x-show="isOpen" x-cloak
        x-transition:enter="ease-out duration-300"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0"
        @click="isOpen = false"
        class="fixed inset-0 bg-black/50 transition-opacity">
    </div>

    <!-- 3. Barra Lateral Off-Canvas -->
    <div x-show="isOpen" x-cloak
        x-transition:enter="transition ease-out duration-300 transform"
        x-transition:enter-start="translate-x-full"
        x-transition:enter-end="translate-x-0"
        x-transition:leave="transition ease-in duration-300 transform"
        x-transition:leave-start="translate-x-0"
        x-transition:leave-end="translate-x-full"
        @click.away="isOpen = false"
        class="fixed inset-y-0 right-0 w-full max-w-sm bg-dark shadow-2xl overflow-y-auto flex flex-col">

        <!-- Header -->
        <div class="p-6 border-b border-primary/20 sticky top-0 bg-dark z-10">
            <div class="flex justify-between items-center">
                <h3 class="text-2xl font-orbitron font-bold text-light">
                    SEU CARRINHO (<span x-text="itemCount"></span>)
                </h3>
                <button @click="isOpen = false" class="text-light hover:text-primary transition p-2 rounded-full hover:bg-white/10" aria-label="Fechar Carrinho">
                    <i data-feather="x" class="w-6 h-6"></i>
                </button>
            </div>
        </div>

        <!-- Conte√∫do do Carrinho (Scrollable) -->
        <div class="flex-grow p-6 space-y-4">
            <div x-show="isLoading" class="text-center text-primary/70 py-10">
                <svg class="animate-spin h-6 w-6 text-primary mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <p class="mt-2 text-sm">Carregando itens...</p>
            </div>
            
            <template x-if="!isLoading && cartItems.length === 0">
                <div class="text-center py-10 text-light/70">
                    <p>Seu carrinho est√° vazio. Vamos √†s compras!</p>
                </div>
            </template>
            
            <template x-for="item in cartItems" :key="item.id">
                <div class="flex items-center space-x-4 p-3 bg-dark/50 rounded-lg border border-primary/10">
                    <!-- Imagem -->
                    <img :src="item.image_url" :alt="item.name" class="w-16 h-16 object-cover rounded-md border border-primary/30">
                    
                    <div class="flex-grow">
                        <p class="font-bold text-light" x-text="item.name"></p>
                        <p class="text-sm text-light/70">
                            Qtd: <span x-text="item.quantity"></span> &times; 
                            R$ <span x-text="item.price.toFixed(2)"></span>
                        </p>
                    </div>
                    
                    <span class="font-semibold text-primary">
                        R$ <span x-text="(item.price * item.quantity).toFixed(2)"></span>
                    </span>

                    <!-- Bot√£o de Remover (A√ß√£o de backend real necess√°ria) -->
                    <!-- Voc√™ precisaria criar uma rota Flask para remover o item/diminuir a quantidade -->
                    <button @click.prevent.stop="alert('Funcionalidade de remover item precisa de uma rota Flask!')" class="text-light/50 hover:text-red-500 transition" aria-label="Remover item">
                        <i data-feather="trash-2" class="w-5 h-5"></i>
                    </button>
                </div>
            </template>
        </div>

        <!-- Footer / Checkout -->
        <div class="p-6 border-t border-primary/20 sticky bottom-0 bg-dark z-10">
            <div class="flex justify-between items-center mb-4 text-light">
                <span class="text-lg font-bold">Total:</span>
                <span class="text-2xl font-orbitron font-bold text-primary">R$ <span x-text="cartTotal.toFixed(2)"></span></span>
            </div>
            <a href="/carrinho" class="block w-full text-center bg-primary hover:bg-primary/80 text-dark font-bold py-3 rounded-full transition duration-200">
                IR PARA O CHECKOUT
            </a>
            <p class="text-center text-xs text-light/60 mt-2">Voc√™ ser√° redirecionado para a p√°gina de carrinho completa.</p>
        </div>
    </div>
</div> 
<body class="bg-dark text-light font-rubik">
    {% include 'header.html' %}

    <!-- Hero Section -->
    <section class="bg-dark/70 min-h-screen flex items-center justify-center pt-16 pb-24 px-4 sm:px-6 lg:px-8">
        <div id="vanta-bg" class="absolute inset-0 -z-10"></div>
        <div class="max-w-7xl mx-auto text-center">
            <div class=" text-primary mb-8">
                <i data-feather="cpu" class="h-32 w-32 mx-auto"></i>
            </div>
            <h1 class="text-4xl md:text-6xl lg:text-7xl font-orbitron font-bold mb-6">
                <span class="text-primary">ROYALE</span><span class="text-secondary">HUB</span>
            </h1>
            <p class="text-lg md:text-xl lg:text-2xl max-w-3xl mx-auto mb-10">
                Domine a arena.
            </p>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <a href="{{ url_for('time') }}" class="bg-primary hover:bg-primary/90 text-dark font-bold py-3 px-8 rounded-full transition transform hover:scale-105">
                    CONHE√áA O TIME
                </a>
                <a href="{{ url_for('loja') }}" class="border-2 border-primary hover:bg-primary/10 text-primary font-bold py-3 px-8 rounded-full transition transform hover:scale-105">
                    LOJA
                </a>
            </div>
            <div class="mt-16 flex justify-center space-x-6">
                <a href="#" class="text-light hover:text-primary transition">
                    <i data-feather="twitter" class="w-6 h-6"></i>
                </a>
                <a href="#" class="text-light hover:text-primary transition">
                    <i data-feather="instagram" class="w-6 h-6"></i>
                </a>
                <a href="#" class="text-light hover:text-primary transition">
                    <i data-feather="twitch" class="w-6 h-6"></i>
                </a>
                <a href="#" class="text-light hover:text-primary transition">
                    <i data-feather="youtube" class="w-6 h-6"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- News Section -->
    <section id="news" class="py-20 px-4 sm:px-6 lg:px-0 bg-dark" 
        x-data="{ current: 0, total: {{ noticias|length }} }">
        <div class="max-w-7xl mx-auto text-center mb-16">
        <h2 class="text-3xl md:text-4xl lg:text-5xl font-orbitron font-bold mb-4">
            <span class="text-primary">BREAKING</span> <span class="text-secondary">NEWS</span>
        </h2>
        <p class="max-w-2xl mx-auto text-light/80">
            Acompanhe nossas not√≠cias do cen√°rio.
        </p>
        </div>

        <div class="relative overflow-hidden">
                <div class="flex transition-transform duration-500"
            :style="`transform: translateX(-${current * 100}%)`">

            {% for news_item in noticias %}
                    <div class="flex-shrink-0 w-full flex justify-center">
            <div class="relative w-[90%] sm:w-[500px] md:w-[600px] lg:w-[700px] rounded-xl overflow-hidden">
                
                            <img 
                                src="{{ url_for('static', filename='uploads/news/' + news_item.image_file) if news_item.image_file else 'https://via.placeholder.com/600x300' }}" 
                                class="w-full h-auto object-cover rounded-xl"
                            >
                
                            <div class="absolute bottom-0 left-0 bg-black/60 p-4 rounded-tr-xl">
                <h3 class="text-xl sm:text-2xl font-orbitron font-bold text-primary mb-1">{{ news_item.title }}</h3>
                <p class="text-light/80 text-sm sm:text-base">{{ news_item.description[:100] }}...</p>
                </div>
            </div>
            </div>
            {% endfor %}

        </div>

                <button @click="current = (current === 0 ? total - 1 : current - 1)"
            class="absolute top-1/2 -translate-y-1/2 bg-primary/40 hover:bg-primary/80 text-white p-3 rounded-full
                left-8 md:left-24 z-20 flex items-center justify-center transition">
            <i data-feather="chevron-left" class="w-5 h-5"></i>
        </button>

        <button @click="current = (current === total - 1 ? 0 : current + 1)"
            class="absolute top-1/2 -translate-y-1/2 bg-primary/40 hover:bg-primary/80 text-white p-3 rounded-full
                right-8 md:right-24 z-20 flex items-center justify-center transition">
            <i data-feather="chevron-right" class="w-5 h-5"></i>
        </button>
        </div>
    </section>

    <!-- Team Section -->
    <section id="team" class="py-20 px-4 sm:px-6 lg:px-0 bg-dark">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-orbitron font-bold mb-4">
                <span class="text-primary">MEET</span> <span class="text-secondary">THE SQUAD</span>
                </h2>
                <p class="max-w-2xl mx-auto text-light/80">
                Conhe√ßa nosso roaster preparado para dominar o competitivo.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                {% for p in players %}
                <div class="bg-dark/50 border border-primary/20 rounded-xl overflow-hidden transform hover:scale-105 transition duration-500">
                    <div class="relative h-64 overflow-hidden">
                        {% if p.image_file %}
                        <img src="{{ url_for('static', filename='uploads/players/' + p.image_file) }}" 
                            alt="{{ p.name }}" 
                            class="w-full h-full object-cover">
                        {% else %}
                        <img src="{{ url_for('static', filename='images/placeholder_player.jpg') }}" 
                            alt="{{ p.name }} (Sem Imagem)" 
                            class="w-full h-full object-cover">
                        {% endif %}
                        <div class="absolute inset-0 bg-gradient-to-t from-dark via-transparent to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-4">
                            <h3 class="text-2xl font-orbitron font-bold text-light">{{ p.name }}</h3>
                            <p class="text-secondary">{{ p.role }}</p>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <span class="bg-primary/10 text-primary text-xs font-semibold px-2.5 py-0.5 rounded">{{ p.game }}</span>
                        </div>
                        <div class="flex space-x-3">
                            {% if p.twitter %}<a href="{{ p.twitter }}" class="text-light hover:text-primary transition"><i data-feather="twitter" class="w-4 h-4"></i></a>{% endif %}
                            {% if p.instagram %}<a href="{{ p.instagram }}" class="text-light hover:text-primary transition"><i data-feather="instagram" class="w-4 h-4"></i></a>{% endif %}
                            {% if p.twitch %}<a href="{{ p.twitch }}" class="text-light hover:text-primary transition"><i data-feather="twitch" class="w-4 h-4"></i></a>{% endif %}
                            {% if p.youtube %}<a href="{{ p.youtube }}" class="text-light hover:text-primary transition"><i data-feather="youtube" class="w-4 h-4"></i></a>{% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Schedule Section -->
    <section id="news" class="py-20 px-4 sm:px-6 lg:px-0 bg-dark">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-orbitron font-bold mb-4">
                    <span class="text-primary">PRESS</span> <span class="text-secondary">START</span>
                </h2>
                <p class="max-w-2xl mx-auto text-light/80">
                    Anote na agenda nossos pr√≥ximos confrontos.
                </p>
            </div>
            <div class="grid md:grid-cols-2 gap-8">
                {% for m in matches %}
                <div class="bg-dark border border-primary/30 rounded-2xl p-6 shadow-lg hover:shadow-primary/30 transition duration-300">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-primary font-orbitron">
                            {{ m.tournament }}
                        </h2>
                        <span class="text-secondary text-lg font-semibold">
                            {{ m.time.strftime('%H:%M') }}
                        </span>
                    </div>
                    <div class="text-light/90 text-lg mb-2">
                        <span class="font-semibold text-light">Advers√°rio:</span> 
                        {{ m.opponent }}
                    </div>
                    <div class="text-light/90 text-lg mb-2">
                        <span class="font-semibold text-light">Data:</span> 
                        {{ m.date.strftime('%d/%m/%Y') }}
                    </div>
                    <div class="mt-4">
                        <span class="inline-block bg-primary text-light px-4 py-1 rounded-full text-sm font-semibold">
                            {{ m.date.strftime('%d %b') }} ‚Ä¢ {{ m.time.strftime('%H:%M') }}
                        </span>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Merch Section -->
    <section id="merch" class="py-20 px-4 sm:px-6 lg:px-8 bg-dark" x-data="{ modalOpen: false, product: {} }">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-orbitron font-bold mb-4">
                <span class="text-primary">REP</span> <span class="text-secondary">THE BRAND</span>
                </h2>
                <p class="max-w-2xl mx-auto text-light/80">
                Merchandise oficial da RoyaleHub, vista-se como um campe√£o.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                {% for p in products[:4] %}
                {% set image_src = url_for('static', filename='uploads/products/' + p.image_file) if p.image_file else 'http://static.photos/black/640x360/1' %}

                <div class="bg-dark/50 border border-primary/20 rounded-xl overflow-hidden transform hover:scale-105 transition duration-300">
                    <div class="relative h-64 overflow-hidden cursor-pointer"
                        @click="modalOpen = true; product = { 
                            id: {{ p.id }}, 
                            name: '{{ p.name }}', 
                            price: {{ p.price }}, 
                            description: '{{ p.description|default('Sem descri√ß√£o', true)|e }}', 
                            image_url: '{{ image_src }}'   
                        }">
                        
                        {% if p.image_file %}
                        <img src="{{ image_src }}" 
                            alt="{{ p.name }}" 
                            class="w-full h-full object-cover">
                        {% else %}
                        <img src="http://static.photos/black/640x360/1" alt="{{ p.name }}" class="w-full h-full object-cover">
                        {% endif %}

                        <div class="absolute top-4 right-4">
                        {% if p.tag %}
                            <span class="bg-primary text-dark text-xs font-bold px-2 py-1 rounded-full">{{ p.tag }}</span>
                        {% endif %}
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-light mb-2">{{ p.name }}</h3>
                        <div class="flex items-center mb-4">
                            <div class="flex text-secondary">
                            {% for i in range(p.rating) %}
                            <i data-feather="star" class="w-4 h-4 fill-current"></i>
                            {% endfor %}
                            </div>
                            <span class="text-xs text-light/60 ml-2">({{ p.reviews or 0 }})</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-primary font-bold text-lg">R$ {{ "%.2f"|format(p.price) }}</span>
                            
                            <button @click="modalOpen = true; product = { 
                                id: {{ p.id }}, 
                                name: '{{ p.name }}', 
                                price: {{ p.price }}, 
                                description: '{{ p.description|default('Sem descri√ß√£o', true)|e }}', 
                                image_url: '{{ image_src }}'
                            }" 
                            class="bg-primary hover:bg-primary/90 text-dark font-bold py-2 px-4 rounded-full text-sm transition">
                            DETALHES
                            </button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <div class="text-center mt-12">
                <a href="{{ url_for('loja') }}" class="inline-flex items-center px-6 py-3 border border-primary text-primary font-bold rounded-full hover:bg-primary/10 transition">
                VER TODO MERCHANDISE
                <i data-feather="arrow-right" class="ml-2 w-5 h-5"></i>
                </a>
            </div>
        </div>
        
        <div x-show="modalOpen" x-transition x-cloak class="fixed inset-0 z-50 flex items-center justify-center bg-black/70">
            <div @click.away="modalOpen = false" class="bg-dark rounded-xl max-w-lg w-full p-6 relative">
                <button @click="modalOpen = false" class="absolute top-4 right-4 text-light hover:text-primary">
                    <i data-feather="x" class="w-6 h-6"></i>
                </button>
                <img :src="product.image_url" class="w-full h-64 object-cover rounded-lg mb-4">
                <h3 class="text-2xl font-bold text-light mb-2" x-text="product.name"></h3>
                <p class="text-light/80 mb-4" x-text="product.description"></p>
                <div class="flex justify-between items-center mb-4">
                    <span class="text-primary font-bold text-lg" x-text="'R$ ' + (typeof product.price === 'number' ? product.price.toFixed(2) : product.price)"></span>
                    <button @click="
                    fetch('/add-to-cart/' + product.id, { method: 'POST' })
                    .then(() => window.location.href='/carrinho')
                    " class="bg-primary hover:bg-primary/90 text-dark font-bold py-2 px-4 rounded-full text-sm transition">
                    ADICIONAR AO CARRINHO
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Section -->
    <section id="live" class="py-16 px-4 sm:px-6 lg:px-8 bg-dark">
        <div id="vanta-live" class="absolute inset-0 -z-10"></div>
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-orbitron font-bold mb-4">
                    <span class="text-primary">LIVE</span> <span class="text-secondary">ON</span>
                </h2>
                <p class="max-w-2xl mx-auto text-light/80">
                    Acompanhe a nossa jornada.
                </p>
            </div>

        <div class="max-w-6xl mx-auto grid md:grid-cols-2 gap-10 px-6">
            <!-- Twitch -->
            <div class="aspect-video rounded-2xl overflow-hidden shadow-lg">
            <iframe
                src="https://player.twitch.tv/?channel=LTASul&parent=e-sports-v89u.onrender.com"
                frameborder="0"
                allowfullscreen
                scrolling="no"
                height="100%"
                width="100%">
            </iframe>
            </div>

            <!-- YouTube -->
            <div class="aspect-video rounded-2xl overflow-hidden shadow-lg">
            <iframe
                src="https://www.youtube.com/embed/T5KLIoZRFCw?autoplay=0"
                title="YouTube Live"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen
                height="100%"
                width="100%">
            </iframe>
            </div>
        </div>
    </section>

    <!-- Sponsors Section -->
    <section id="sponsors" class="py-16 px-4 sm:px-6 lg:px-8 bg-dark">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-orbitron font-bold mb-4">
                <span class="text-primary">OUR</span> <span class="text-secondary">PARTNERS</span>
                </h2>
                <p class="max-w-2xl mx-auto text-light/80">
                Nossas principais parcerias.
                </p>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-8">
                {% for s in sponsors %}
                <div class="flex items-center justify-center p-4 bg-dark/50 border border-primary/20 rounded-lg h-24">
                            {% if s.logo_file %}
                <img src="{{ url_for('static', filename='uploads/sponsors/' + s.logo_file) }}" 
                                alt="{{ s.name }}" 
                                class="h-12 object-contain">
                            {% else %}
                            <img src="{{ url_for('static', filename='images/placeholder_sponsor.png') }}" 
                                alt="{{ s.name }} (Logo Missing)" 
                                class="h-12 object-contain">
                            {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    {% include 'footer.html' %}

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script>
        // Initialize Vanta.js background
        VANTA.NET({
        el: "#vanta-bg",
        mouseControls: true,
        touchControls: true,
        minHeight: 200.00,
        minWidth: 200.00,
        scale: 1.00,
        scaleMobile: 1.00,
        color: 0xff0000,
        backgroundColor: 0x0a0908, 
        points: 10.00,
        maxDistance: 25.00,
        spacing: 18.00
        });

        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });
    </script>
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('cartOffCanvas', () => ({
                isOpen: false,
                cartItems: [],
                isLoading: false,

                get cartTotal() {
                    return this.cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                },
                
                get itemCount() {
                    return this.cartItems.reduce((sum, item) => sum + item.quantity, 0);
                },
                
                // üöÄ NOVO: Adiciona a fun√ß√£o init() para monitorar o estado
                init() {
                    // Monitora a vari√°vel 'isOpen'
                    this.$watch('isOpen', (value) => {
                        // Usa classList para garantir que a classe seja adicionada/removida corretamente
                        document.body.classList.toggle('overflow-hidden', value);
                        
                        // Se preferir a manipula√ß√£o direta do style (menos recomendado, mas pode funcionar se classList n√£o resolver):
                        // document.body.style.overflow = value ? 'hidden' : '';
                    });
                },

                // üõ†Ô∏è toggleCart AGORA S√ì ALTERA O ESTADO
                toggleCart() {
                    this.isOpen = !this.isOpen;
                    // A manipula√ß√£o da barra de rolagem √© feita pelo $watch acima
                },

                async fetchCartData() {
                    if (this.isLoading) return;
                    this.isLoading = true;
                    
                    try {
                        // Chama a rota Flask que criamos no app.py
                        const response = await fetch('/api/cart');
                        if (!response.ok) {
                            throw new Error(`Erro HTTP: ${response.status}`);
                        }
                        const data = await response.json();
                        
                        this.cartItems = data.items;
                        
                    } catch (error) {
                        console.error('Erro ao buscar o carrinho:', error);
                    } finally {
                        this.isLoading = false;
                    }
                }
            }));
        });
        // Inicia os √≠cones feather-icons
        if (typeof feather !== 'undefined') {
            feather.replace();
        }
    </script>
</body>
</html>
